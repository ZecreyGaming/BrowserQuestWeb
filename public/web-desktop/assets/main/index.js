System.register("chunks:///_virtual/AStar.ts",["cc"],(function(n){"use strict";var e;return{setters:[function(n){e=n.cclegacy}],execute:function(){e._RF.push({},"53dc7gpMUxDNoAyRWV0jJ0Q","AStar",void 0);
/**
           * A* (A-Star) algorithm for a path finder
           * @author  Andrea Giammarchi
           * @license Mit Style License
      */
n("default",function(){function n(){}var e=n.prototype;return e.find=function(n,e,t,r){void 0===r&&(r=null);var a,s,i,c,o,u,y,l,x,f=n[0].length,h=n.length,g=f*h,d=Math.abs,v=Math.max,p={},S=[],F=[{x:e[0],y:e[1],f:0,g:0,v:e[0]+e[1]*f}],D=1;switch(t={x:t[0],y:t[1],v:t[0]+t[1]*f},r){case"Diagonal":i=this.diagonalSuccessors;case"DiagonalFree":s=this.diagonal;break;case"Euclidean":i=this.diagonalSuccessors;case"EuclideanFree":v=Math.sqrt,s=this.euclidean;break;default:s=this.manhattan,i=this.nothingToDo}i||(i=this.diagonalSuccessorsFree);do{for(u=g,y=0,c=0;c<D;++c)(r=F[c].f)<u&&(u=r,y=c);if((l=F.splice(y,1)[0]).v!=t.v)for(--D,c=0,o=(x=this.successors(i,l.x,l.y,n,h,f)).length;c<o;++c)(a=x[c]).p=l,a.f=a.g=0,a.v=a.x+a.y*f,a.v in p||(a.f=(a.g=l.g+s(a,l,d,v))+s(a,t,d,v),F[D++]=a,p[a.v]=1);else{c=D=0;do{S[c++]=[l.x,l.y]}while(l=l.p);S.reverse()}}while(D);return S},e.diagonalSuccessors=function(n,e,t,r,a,s,i,c,o,u,y,l,x){return n&&(t&&!o[a][i]&&(l[x++]={x:i,y:a}),r&&!o[a][c]&&(l[x++]={x:c,y:a})),e&&(t&&!o[s][i]&&(l[x++]={x:i,y:s}),r&&!o[s][c]&&(l[x++]={x:c,y:s})),l},e.diagonalSuccessorsFree=function(n,e,t,r,a,s,i,c,o,u,y,l,x){return n=a>-1,e=s<u,r=c>-1,i<y&&(n&&!o[a][i]&&(l[x++]={x:i,y:a}),e&&!o[s][i]&&(l[x++]={x:i,y:s})),r&&(n&&!o[a][c]&&(l[x++]={x:c,y:a}),e&&!o[s][c]&&(l[x++]={x:c,y:s})),l},e.nothingToDo=function(n,e,t,r,a,s,i,c,o,u,y,l,x){return l},e.successors=function(n,e,t,r,a,s){var i=t-1,c=t+1,o=e+1,u=e-1,y=i>-1&&!r[i][e],l=c<a&&!r[c][e],x=o<s&&!r[t][o],f=u>-1&&!r[t][u],h=[],g=0;return y&&(h[g++]={x:e,y:i}),x&&(h[g++]={x:o,y:t}),l&&(h[g++]={x:e,y:c}),f&&(h[g++]={x:u,y:t}),n(y,l,x,f,i,c,o,u,r,a,s,h,g)},e.diagonal=function(n,e,t,r){return r(t(n.x-e.x),t(n.y-e.y))},e.euclidean=function(n,e,t,r){var a=n.x-e.x,s=n.y-e.y;return r(a*a+s*s)},e.manhattan=function(n,e,t,r){return t(n.x-e.x)+t(n.y-e.y)},n}());e._RF.pop()}}}));

System.register("chunks:///_virtual/Character.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Entity.ts","./Map.ts"],(function(t){"use strict";var i,e,n,s,a,h;return{setters:[function(t){i=t.inheritsLoose},function(t){e=t.cclegacy,n=t.v3,s=t.tween},function(t){a=t.default},function(t){h=t.Types}],execute:function(){e._RF.push({},"1e6e2O9P8tCB4P9UFMMPXbR","Character",void 0);t("default",function(t){function e(i,e){var n;return(n=t.call(this,i)||this).characterView=null,n.path=null,n.step=0,n.followingMode=!1,n.interrupted=!1,n.stop_pathing_callback=null,n.start_pathing_callback=null,n.request_path_callback=null,n.checkaggro_callback=null,n.step_callback=null,n.before_step_callback=null,n.destination=null,n.newDestination=null,n.attackingMode=!1,n.target=null,n.moveTween=null,n.characterView=e,n.id=e.id,n}i(e,t);var a=e.prototype;return a.setPosition=function(i,e){t.prototype.setPosition.call(this,i,e),this.characterView.node.setPosition(i,e)},a.setOrientation=function(t){this.orientation=t;var i=1;this.orientation==h.Orientations.LEFT&&(t=h.Orientations.RIGHT,i=-1),this.characterView.node.scale.x!=i&&this.characterView.node.setScale(n(i,this.characterView.node.scale.y)),this.characterView.setOrientation(t)},a.go=function(t,i){this.isAttacking()?this.disengage():this.followingMode&&(this.followingMode=!1,this.target=null),this.moveTo(t,i)},a.moveTo=function(t,i){if(this.destination={gridX:t,gridY:i},this.isMoving())this.continueTo(t,i);else{var e=this.requestPathfindingTo(t,i);this.followPath(e)}},a.stop=function(){if(this.isMoving()){this.interrupted=!0;var t=this.moveTween;t&&t.stop(),this.moveTween=null}},a.isNear=function(t,i){var e,n,s=!1;return e=Math.abs(this.gridX-t.gridX),n=Math.abs(this.gridY-t.gridY),e<=i&&n<=i&&(s=!0),s},a.requestPathfindingTo=function(t,i){return this.game.findPath(this,t,i,null)},a.followPath=function(t){if(t.length>1){this.path=t,this.step=0;var i=this.moveTween;i&&i.stop(),this.moveTween=null,this.followingMode&&t.pop(),this.start_pathing_callback&&this.start_pathing_callback(t),this.nextStep()}},a.nextStep=function(){var t,i,e,a=this,h=!1;if(this.isMoving()){if(this.before_step_callback&&this.before_step_callback(),this.interrupted)h=!0,this.interrupted=!1;else{if(this.hasNextStep()){this.nextGridX=this.path[this.step+1][0],this.nextGridY=this.path[this.step+1][1];var o=this.game.gridToMapPosition(this.nextGridX,this.nextGridY);this.moveTween=s(this.characterView.node).to(.1,{position:n(o.x,o.y)}).call((function(){a.gridX=a.nextGridX,a.gridY=a.nextGridY,a.checkAggro(),a.nextStep()})).start()}this.step_callback&&this.step_callback(),this.hasChangedItsPath()?(t=this.newDestination.x,i=this.newDestination.y,e=this.requestPathfindingTo(t,i),this.newDestination=null,e.length<2?h=!0:this.followPath(e)):this.hasNextStep()?(this.step+=1,this.updateMovement()):h=!0}if(h){this.path=null;var l=this.moveTween;l&&l.stop(),this.moveTween=null,this.idle(),this.stop_pathing_callback&&this.stop_pathing_callback(this.gridX,this.gridY)}}},a.isAttacking=function(){return this.attackingMode},a.isMoving=function(){return!(null===this.path)},a.hasNextStep=function(){return this.path.length-1>this.step},a.hasChangedItsPath=function(){return!(null===this.newDestination)},a.continueTo=function(t,i){this.newDestination={x:t,y:i}},a.updateMovement=function(){var t=this.path,i=this.step;t[i][0]<t[i-1][0]&&this.walk(h.Orientations.LEFT),t[i][0]>t[i-1][0]&&this.walk(h.Orientations.RIGHT),t[i][1]<t[i-1][1]&&this.walk(h.Orientations.UP),t[i][1]>t[i-1][1]&&this.walk(h.Orientations.DOWN)},a.disengage=function(){this.attackingMode=!1,this.followingMode=!1,this.removeTarget()},a.removeTarget=function(){this.target&&(this.target=null)},a.hasTarget=function(){return!(null===this.target)},a.walk=function(t){this.setOrientation(t),this.animate("walk")},a.idle=function(){this.animate("idle")},a.animate=function(t){this.characterView.setAnimation(t)},a.updatePositionOnGrid=function(){this.setGridPosition(this.path[this.step][0],this.path[this.step][1])},a.onCheckAggro=function(t){this.checkaggro_callback=t},a.checkAggro=function(){this.checkaggro_callback&&this.checkaggro_callback()},a.onRequestPath=function(t){this.request_path_callback=t},a.onStartPathing=function(t){this.start_pathing_callback=t},a.onStopPathing=function(t){this.stop_pathing_callback=t},a.onBeforeStep=function(t){this.before_step_callback=t},a.onStep=function(t){this.step_callback=t},e}(a));e._RF.pop()}}}));

System.register("chunks:///_virtual/Chest.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,r,i,n,o,c,s;return{setters:[function(t){e=t.applyDecoratedDescriptor,r=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){o=t.cclegacy,c=t._decorator,s=t.Component}],execute:function(){var a,u,l,p,f;o._RF.push({},"a5ff4QbFmhKwq4K2U3+7bsP","Chest",void 0);var h=c.ccclass,y=c.property;t("Chest",(a=h("Chest"),u=y(Number),a((f=e((p=function(t){function e(){for(var e,r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o))||this,i(e,"id",f,n(e)),e}r(e,t);var o=e.prototype;return o.start=function(){},o.update=function(t){},e}(s)).prototype,"id",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),l=p))||l));o._RF.pop()}}}));

System.register("chunks:///_virtual/Entity.ts",["cc"],(function(t){"use strict";var i;return{setters:[function(t){i=t.cclegacy}],execute:function(){i._RF.push({},"b584eZKOO9CqbHgfcfXNffr","Entity",void 0);t("default",function(){function t(t){this.game=null,this.id=null,this.name=null,this.gridX=0,this.gridY=0,this.nextGridX=0,this.nextGridY=0,this.orientation=1,this.game=t}var i=t.prototype;return i.setPosition=function(t,i){},i.setGridPosition=function(t,i){this.gridX=t,this.gridY=i;var n=this.game.gridToMapPosition(t,i);this.setPosition(n.x,n.y)},t}());i._RF.pop()}}}));

System.register("chunks:///_virtual/Game.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Map.ts","./Pathfinder.ts","./Player.ts"],(function(t){"use strict";var i,o,e,n,s,h,a,r,l,p,c,u,d,f;return{setters:[function(t){i=t.inheritsLoose},function(t){o=t.cclegacy,e=t.UITransform,n=t.resources,s=t.JsonAsset,h=t.instantiate,a=t.Label,r=t.Node,l=t.Vec2,p=t.Vec3,c=t.EventTarget},function(t){u=t.default},function(t){d=t.default},function(t){f=t.default}],execute:function(){o._RF.push({},"f35e5GNbYxDrInkLJtSxby2","Game",void 0);var m=t("GameEvent",{LoadComplete:"LoadComplete"});t("default",function(t){function o(){for(var i,o=arguments.length,e=new Array(o),n=0;n<o;n++)e[n]=arguments[n];return(i=t.call.apply(t,[this].concat(e))||this).player=null,i.map=null,i.mapViewWidth=0,i.mapViewHeight=0,i.mapView=null,i.playerView=null,i.pathingGrid=null,i.pathfinder=null,i.mapScrollView=null,i.mapTF=null,i.isMapMoving=!1,i.posTouchStart=null,i.mapEnable=!1,i.touchMapCallback=null,i.selectedGoodsId=0,i.touchV2Pos=new l,i.touchUIV2Pos=new l,i.touchV3Pos=new p,i.mapV3Pos=new p,i.touchGridPos={x:0,y:0},i}i(o,t);var c=o.prototype;return c.initView=function(t,i,o){this.mapView=t,this.playerView=i,this.mapScrollView=o,this.mapTF=this.mapView.getComponent(e),this.mapViewWidth=this.mapTF.width,this.mapViewHeight=this.mapTF.height},c.loadGame=function(){var t=this;n.load("map/map",s,(function(i,o){null!=o?(console.log("Load Map JSON Succ."),t.map=new u,t.map.loadMap(o.json,1.2),t.playerView.node.active=!0,t.player=new f(t,t.playerView),t.player.setGridPosition(32,162),t.pathfinder=new d(t.map.width,t.map.height),t.initPathingGrid(),t.emit(m.LoadComplete)):console.error(i)}))},c.showMapDebug=function(t,i){void 0===i&&(i=50),t.getComponent(e).setContentSize(this.map.tilesize,this.map.tilesize);for(var o=0;o<this.pathingGrid.length;o++)if(!(i>0&&o>i))for(var n=0;n<this.pathingGrid[o].length;n++)if(!(i>0&&n>i)&&this.pathingGrid[o][n]>=1){var s=h(t),r="G-"+n+"x"+o,l=s.getComponent(a);null!=l&&(l.string=r),s.name=r,s.active=!0,s.parent=this.mapView;var p=this.gridToMapPosition(n,o);s.setPosition(p.x,p.y)}},c.setMapEnable=function(t){this.mapEnable!=t&&(this.mapEnable=t,this.mapEnable?this.onEnable():this.onDisable())},c.onEnable=function(){this.mapScrollView.node.on(r.EventType.TOUCH_END,this.onTouchEnd,this),this.mapScrollView.node.on(r.EventType.TOUCH_START,this.onTouchStart,this),this.mapScrollView.node.on(r.EventType.TOUCH_MOVE,this.onTouchMove,this)},c.onDisable=function(){this.mapScrollView.node.off(r.EventType.TOUCH_END,this.onTouchEnd,this),this.mapScrollView.node.off(r.EventType.TOUCH_START,this.onTouchStart,this),this.mapScrollView.node.off(r.EventType.TOUCH_MOVE,this.onTouchMove,this)},c.onTouchStart=function(t){this.isMapMoving=!1,this.posTouchStart=t.getUILocation()},c.onTouchMove=function(t){var i=t.getUILocation(),o=l.distance(this.posTouchStart,i);Math.abs(o)>=5&&(this.isMapMoving=!0)},c.onTouchEnd=function(t){if(1!=this.isMapMoving){t.getUILocation(this.touchUIV2Pos),this.touchV3Pos.x=this.touchUIV2Pos.x,this.touchV3Pos.y=this.touchUIV2Pos.y,this.mapTF.convertToNodeSpaceAR(this.touchV3Pos,this.mapV3Pos),this.mapToGridPosition(this.mapV3Pos.x,this.mapV3Pos.y,this.touchGridPos);var i=this.getPathingGridNum(this.touchGridPos.x,this.touchGridPos.y);this.selectedGoodsId=0,i>=3&&i<=10&&(this.selectedGoodsId=i,this.findGoodsFoothold(this.touchGridPos.x,this.touchGridPos.y,this.touchGridPos)),this.player.go(this.touchGridPos.x,this.touchGridPos.y),null!=this.touchMapCallback&&(t.getLocation(this.touchV2Pos),this.touchMapCallback(this.touchV2Pos,this.mapV3Pos,this.touchGridPos.x,this.touchGridPos.y))}},c.update=function(t){this.mapEnable},c.gridToMapPosition=function(t,i,o){var e=t*this.map.tilesize,n=this.mapViewHeight-i*this.map.tilesize;return null!=o?(o.x=e,void(o.y=n)):{x:e,y:n}},c.mapToGridPosition=function(t,i,o){var e=Math.floor(t/this.map.tilesize),n=Math.floor((this.mapViewHeight-i)/this.map.tilesize);return null!=o?(o.x=e,void(o.y=n)):{x:e,y:n}},c.initPathingGrid=function(){this.pathingGrid=[];for(var t=0;t<this.map.height;t+=1){this.pathingGrid[t]=[];for(var i=0;i<this.map.width;i+=1)this.pathingGrid[t][i]=this.map.grid[t][i]}},c.setPathingGrid=function(t,i,o){this.pathingGrid[i][t]=o,console.log("setPathingGrid: x = "+t+", gy = "+i)},c.getPathingGridNum=function(t,i){return this.pathingGrid[i][t]},c.findPath=function(t,i,o,e){var n=this,s=this.pathingGrid,h=[];this.player;return this.map.isColliding(i,o)||(this.pathfinder&&t?(e&&e.forEach((function(t){n.pathfinder.ignoreEntity(t)})),h=this.pathfinder.findPath(s,t,i,o,!1),e&&this.pathfinder.clearIgnoreList()):console.error("Error while finding the path to "+i+", "+o+" for "+t.id)),h},c.setTouchMapCallback=function(t){this.touchMapCallback=t},c.findGoodsFoothold=function(t,i,o){for(var e=this.player.gridX-t<0?-1:1,n=this.player.gridY-i<0?-1:1,s=t,h=i,a=!1,r=0;r<10;r++){for(var l=0;l<10;l++)if(s+=e,h+=n,0==this.getPathingGridNum(s,h)){a=!0;break}if(1==a)break}return!(!a||!o)&&(o.x=s,o.y=h,!0)},c.getSelectedGoodsId=function(){return this.selectedGoodsId},o}(c));o._RF.pop()}}}));

System.register("chunks:///_virtual/LoadingScene.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Chest.ts","./Game.ts","./NFTSDK.ts","./SpriteAnimation.ts"],(function(t){"use strict";var e,i,n,a,o,r,s,l,h,c,u,p,g,f,m,d,y,b,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){o=t.cclegacy,r=t._decorator,s=t.Node,l=t.ScrollView,h=t.UITransform,c=t.Camera,u=t.view,p=t.tween,g=t.v3,f=t.Component},function(t){m=t.Chest},function(t){d=t.default,y=t.GameEvent},function(t){b=t.NFTSDK},function(t){v=t.SpriteAnimation}],execute:function(){var w,S,L,G,P,x,C,k,z,T,A,V,D,F,I,M,N,B,U;o._RF.push({},"8c8f31HD4BPda6Sr6so8eIe","LoadingScene",void 0);var _=r.ccclass,H=r.property;t("rpgGame",{data:null});window.rpggame={hello:function(t){console.log(t)}};t("LoadingScene",(w=_("LoadingScene"),S=H(s),L=H(s),G=H(v),P=H(l),x=H(h),C=H(b),k=H(s),z=H(c),w((V=e((A=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return e=t.call.apply(t,[this].concat(o))||this,n(e,"mapView",V,a(e)),n(e,"debugNode",D,a(e)),n(e,"character",F,a(e)),n(e,"mapScrollView",I,a(e)),n(e,"chestList",M,a(e)),n(e,"nftSdk",N,a(e)),n(e,"playerArrow",B,a(e)),n(e,"camera",U,a(e)),e.game=new d,e}i(e,t);var o=e.prototype;return o.onLoad=function(){this.nftSdk.gameInit(),this.camera.orthoHeight=u.getVisibleSize().height/2},o.start=function(){this.game.on(y.LoadComplete,this.onGameComplete,this),this.game.initView(this.mapView,this.character,this.mapScrollView),this.game.loadGame()},o.update=function(t){this.game.update(t)},o.onGameComplete=function(){this.game.off(y.LoadComplete,this.onGameComplete,this),this.game.setMapEnable(!0),this.game.setTouchMapCallback(this.onTouchMap.bind(this)),this.game.player.onBeforeStep(this.onBeforeStep.bind(this)),this.game.player.onStopPathing(this.onStopPathing.bind(this)),this.playerArrow.active=!0,p(this.playerArrow).repeatForever(p(this.playerArrow).by(.5,{position:g(0,15)}).by(.4,{position:g(0,-15)})).start();for(var t={x:0,y:0},e=0;e<this.chestList.length;e++){var i=this.chestList[e],n=e+3;this.game.mapToGridPosition(i.node.position.x,i.node.position.y,t),this.game.setPathingGrid(t.x,t.y,n);var a=this.game.gridToMapPosition(t.x,t.y);i.node.position=g(a.x,a.y),this.game.setPathingGrid(t.x+1,t.y-1,n),this.game.setPathingGrid(t.x+1,t.y+1,n),this.game.setPathingGrid(t.x+1,t.y,n),this.game.setPathingGrid(t.x,t.y-1,n),this.game.setPathingGrid(t.x,t.y+1,n),this.game.setPathingGrid(t.x-1,t.y,n),this.game.setPathingGrid(t.x-1,t.y-1,n),this.game.setPathingGrid(t.x-1,t.y+1,n),console.log("chest pos: ",t.x,t.y,n)}var o=this,r=function(t){if(console.log("RPG.updateUserData: ",t),t&&t.assets)for(var e=0;e<o.chestList.length;e++){var i=o.chestList[e].getComponent(m);if(null!=i){var n=t.assets.indexOf(i.id);o.chestList[e].node.active=!(n>=0)}}};this.nftSdk.gameInitComplete(),this.nftSdk.getUserInfo(r.bind(this)),this.nftSdk.setUpdateUserDataCallback(r.bind(this))},o.onTouchMap=function(t,e,i,n){console.log("mapPos = ",e,"grid: = "+i+"x"+n);for(var a=this.chestList.length-1;a>=0;a--){if(this.chestList[a].hitTest(t)){console.log("hit");break}}},o.onBeforeStep=function(){this.playerArrow.active=!1},o.findChest=function(t){for(var e=0;e<this.chestList.length;e++){var i=this.chestList[e].getComponent(m);if(null!=i&&i.id==t)return this.chestList[e]}return null},o.onStopPathing=function(){var t=this;this.playerArrow.active=!0;var e=this.game.getSelectedGoodsId();if(e>=3&&e<=10){var i=e-3,n=this.chestList[i];if(n){p(n.node).to(.1,{angle:-10}).to(.1,{angle:10}).to(.05,{angle:0}).start();var a=this.chestList[i].getComponent(m).id;this.nftSdk.createNTFFromGame(a,(function(e){var i=t.findChest(e);a==e&&null!=i&&null!=i.node&&(i.node.active=!1)}))}}},e}(f)).prototype,"mapView",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(A.prototype,"debugNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(A.prototype,"character",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(A.prototype,"mapScrollView",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(A.prototype,"chestList",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),N=e(A.prototype,"nftSdk",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=e(A.prototype,"playerArrow",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(A.prototype,"camera",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=A))||T));o._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AStar.ts","./Character.ts","./Chest.ts","./Entity.ts","./Game.ts","./LoadingScene.ts","./Map.ts","./NFTSDK.ts","./Pathfinder.ts","./Player.ts","./SpriteAnimation.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/Map.ts",["cc"],(function(i){"use strict";var t;return{setters:[function(i){t=i.cclegacy}],execute:function(){t._RF.push({},"60552/KMUVDa67uskr2KGPz","Map",void 0);var s=i("Types",{Orientations:{UP:1,DOWN:2,LEFT:3,RIGHT:4}}),n=(i("OrientationMap",{1:"up",2:"down",3:"left",4:"right"}),i("Area",function(){function i(i,t,s,n){this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.id=void 0,this.x=i,this.y=t,this.width=s,this.height=n}return i.prototype.contains=function(i){return!!i&&(i.gridX>=this.x&&i.gridY>=this.y&&i.gridX<this.x+this.width&&i.gridY<this.y+this.height)},i}())),o=i("isInt",(function(i){return i%1==0}));i("default",function(){function i(){this.width=10,this.height=10,this.tilesize=16,this.data=null,this.blocking=null,this.plateau=null,this.musicAreas=null,this.collisions=null,this.high=null,this.animated=null,this.doors=null,this.checkpoints=null,this.grid=null,this.plateauGrid=null,this.mapLoaded=!1,this.isLoaded=!1,this.tilescale=1}var t=i.prototype;return t.loadMap=function(i,t){this.tilescale=t,this._initMap(i),this._generateCollisionGrid(),this._generatePlateauGrid(),this.mapLoaded=!0,this.isLoaded=!0},t._initMap=function(i){this.width=i.width,this.height=i.height,this.tilesize=i.tilesize*this.tilescale,this.data=i.data,this.blocking=i.blocking||[],this.plateau=i.plateau||[],this.musicAreas=i.musicAreas||[],this.collisions=i.collisions||[],this.high=i.high,this.animated=i.animated,this.doors=this._getDoors(i),this.checkpoints=this._getCheckpoints(i)},t._getDoors=function(i){var t={},n=this;return i&&null!=i.doors&&i.doors.forEach((function(i){var o=0;switch(i.to){case"u":o=s.Orientations.UP;break;case"d":o=s.Orientations.DOWN;break;case"l":o=s.Orientations.LEFT;break;case"r":o=s.Orientations.RIGHT;break;default:o=s.Orientations.DOWN}t[n.GridPositionToTileIndex(i.x,i.y)]={x:i.tx,y:i.ty,orientation:o,cameraX:i.tcx,cameraY:i.tcy,portal:1===i.p}})),t},t._getCheckpoints=function(i){var t=[];return null!=i.checkpoints&&i.checkpoints.forEach((function(i){var s=new n(i.x,i.y,i.w,i.h);s.id=i.id,t.push(s)})),t},t._generateCollisionGrid=function(){var i=this;this.grid=[];for(var t,s=0;s<this.height;s++)for(this.grid[s]=[],t=0;t<this.width;t++)this.grid[s][t]=0;this.collisions.forEach((function(t){var s=i.tileIndexToGridPosition(t+1);i.grid[s.y][s.x]=1})),this.blocking.forEach((function(t){var s=i.tileIndexToGridPosition(t+1);void 0!==i.grid[s.y]&&(i.grid[s.y][s.x]=1)})),console.info("Collision grid generated.")},t._generatePlateauGrid=function(){var i=0;this.plateauGrid=[];for(var t,s=0;s<this.height;s++)for(this.plateauGrid[s]=[],t=0;t<this.width;t++)null!=this.plateau[i]?this.plateauGrid[s][t]=1:this.plateauGrid[s][t]=0,i+=1;console.info("Plateau grid generated.")},t.isOutOfBounds=function(i,t){return o(i)&&o(t)&&(i<0||i>=this.width||t<0||t>=this.height)},t.isColliding=function(i,t){return!(this.isOutOfBounds(i,t)||!this.grid)&&1===this.grid[t][i]},t.isPlateau=function(i,t){return!(this.isOutOfBounds(i,t)||!this.plateauGrid)&&1===this.plateauGrid[t][i]},t.isDoor=function(i,t){return void 0!==this.doors[this.GridPositionToTileIndex(i,t)]},t.getDoorDestination=function(i,t){return this.doors[this.GridPositionToTileIndex(i,t)]},t.GridPositionToTileIndex=function(i,t){return t*this.width+i+1},t.tileIndexToGridPosition=function(i){var t,s;return t=(i-=1)+1,s=this.width,{x:0==t?0:t%s==0?s-1:t%s-1,y:Math.floor(i/this.width)}},i}());t._RF.pop()}}}));

System.register("chunks:///_virtual/NFTSDK.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,o,a;return{setters:[function(t){e=t.inheritsLoose},function(t){n=t.cclegacy,o=t._decorator,a=t.Component}],execute:function(){var r;n._RF.push({},"592b5MOhWhJ66H+RDz5Wxz6","NFTSDK",void 0);var c=o.ccclass,s=(o.property,t("nftsdk",window.nftsdk||{createNTFFromGame:function(t){console.error("not found ntfsdk.createNTFFromGame Function."),t&&t.cb&&t.cb(t.id)},gameInit:function(){console.error("not found ntfsdk.gameInit Function.")},gameLoadProgress:function(t){console.error("not found ntfsdk.gameLoadProgress Function.")},gameInitComplete:function(){console.error("not found ntfsdk.gameInitComplete Function.")},getUserData:function(t){console.error("not found ntfsdk.getUserData Function."),t&&t({assets:[]})},setUpdateUserDataCallback:function(t){console.error("not found ntfsdk.setUpdateUserDataCallback Function."),window.rpggame.updateUserDataCallback=t}}));t("NFTSDK",c("NFTSDK")(r=function(t){function n(){return t.apply(this,arguments)||this}e(n,t);var o=n.prototype;return o.gameInit=function(){s&&s.gameInit&&s.gameInit()},o.gameInitComplete=function(){s&&s.gameInitComplete&&s.gameInitComplete()},o.createNTFFromGame=function(t,e){s&&s.createNTFFromGame&&s.createNTFFromGame({id:t,cb:e})},o.getUserInfo=function(t){s&&s.getUserData&&s.getUserData(t)},o.setUpdateUserDataCallback=function(t){s&&s.setUpdateUserDataCallback&&s.setUpdateUserDataCallback(t)},n}(a))||r);n._RF.pop()}}}));

System.register("chunks:///_virtual/Pathfinder.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AStar.ts"],(function(i){"use strict";var t,n,r;return{setters:[function(i){t=i.inheritsLoose},function(i){n=i.cclegacy},function(i){r=i.default}],execute:function(){n._RF.push({},"6525c7QCfRJlLzS6eYH6Yw8","Pathfinder",void 0);i("default",function(i){function n(t,n){var r;return(r=i.call(this)||this).width=0,r.height=0,r.grid=null,r.blankGrid=[],r.ignored=[],r.width=t,r.height=n,r.grid=null,r.blankGrid=[],r._initBlankGrid(),r}t(n,i);var r=n.prototype;return r.findPath=function(i,t,n,r,e){var h,s=[t.gridX,t.gridY],o=[n,r];return this.grid=i,this._applyIgnoreList(!0),0===(h=this.find(this.grid,s,o)).length&&!0===e&&(h=this._findIncompletePath(s,o)),h},r._initBlankGrid=function(){for(var i=0;i<this.height;i+=1){this.blankGrid[i]=[];for(var t=0;t<this.width;t+=1)this.blankGrid[i][t]=0}},r._findIncompletePath=function(i,t){for(var n,r,e,h=[],s=(n=this.find(this.blankGrid,i,t)).length-1;s>0;s-=1)if(r=n[s][0],e=n[s][1],0===this.grid[e][r]){h=this.find(this.grid,i,[r,e]);break}return h},r._applyIgnoreList=function(i){var t,n,r=this;this.ignored.forEach((function(e){t=e.isMoving()?e.nextGridX:e.gridX,n=e.isMoving()?e.nextGridY:e.gridY,t>=0&&n>=0&&(r.grid[n][t]=i?0:1)}))},r.ignoreEntity=function(i){i&&this.ignored.push(i)},r.clearIgnoreList=function(){this._applyIgnoreList(!1),this.ignored=[]},n}(r));n._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Character.ts"],(function(t){"use strict";var e,r,n;return{setters:[function(t){e=t.inheritsLoose},function(t){r=t.cclegacy},function(t){n=t.default}],execute:function(){r._RF.push({},"39f88o15r1FirxQaCJCQcg8","Player",void 0);t("default",function(t){function r(){return t.apply(this,arguments)||this}return e(r,t),r}(n));r._RF.pop()}}}));

System.register("chunks:///_virtual/SpriteAnimation.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Map.ts"],(function(i){"use strict";var t,n,a,e,r,s,o,h,p,m,l,u,c,f,y;return{setters:[function(i){t=i.applyDecoratedDescriptor,n=i.inheritsLoose,a=i.initializerDefineProperty,e=i.assertThisInitialized},function(i){r=i.cclegacy,s=i._decorator,o=i.ImageAsset,h=i.JsonAsset,p=i.Sprite,m=i.SpriteFrame,l=i.rect,u=i.v2,c=i.Component},function(i){f=i.Types,y=i.OrientationMap}],execute:function(){var d,g,A,v,D,w,_;r._RF.push({},"d3902p+mtdJFrsnPvoatsoj","SpriteAnimation",void 0);var x=s.ccclass,I=s.property;i("SpriteAnimation",(d=x("SpriteAnimation"),g=I(o),A=I(h),d((w=t((D=function(i){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=i.call.apply(i,[this].concat(r))||this,a(t,"image",w,e(t)),a(t,"config",_,e(t)),t.id=null,t.spriteData={id:"",width:32,height:32,animations:{walk_right:{length:5,row:2}},offset_x:-8,offset_y:-12},t.animations={},t.animationName="idle",t.orientation=f.Orientations.DOWN,t.currentAnimation=null,t.playTime=0,t.playIndex=0,t.playerView=null,t}n(t,i);var r=t.prototype;return r.start=function(){this.spriteData=this.config.json,this.id=this.spriteData.id,this.createSpriteFrame(),this.playerView=this.getComponent(p);var i=this.animationName+"_"+y[this.orientation];this.currentAnimation=this.animations[i],this.playerView.spriteFrame=this.currentAnimation[this.playIndex]},r.update=function(i){this.playTime+=i,this.playTime>=.15&&(this.playTime=0,this.playIndex<this.currentAnimation.length-1?this.playIndex+=1:this.playIndex=0,this.playerView.spriteFrame=this.currentAnimation[this.playIndex])},r.setOrientation=function(i){var t=this.animationName+"_"+y[this.orientation];this.orientation!=i&&null!=this.animations[t]&&(this.orientation=i,this.updateAnimation())},r.setAnimation=function(i){var t=this.animationName+"_"+y[this.orientation];this.animationName!=i&&null!=this.animations[t]&&(this.animationName=i,this.updateAnimation())},r.updateAnimation=function(){this.playIndex=0,this.playTime=0;var i=this.animationName+"_"+y[this.orientation];this.currentAnimation=this.animations[i],this.playerView.spriteFrame=this.currentAnimation[this.playIndex]},r.createSpriteFrame=function(){for(var i in this.spriteData.animations){var t=this.spriteData.animations[i];this.animations[i]=[];for(var n=0;n<t.length;n++){var a=m.createWithImage(this.image);a.rect=l(n*this.spriteData.width,t.row*this.spriteData.height,this.spriteData.width,this.spriteData.height),a.offset=u(this.spriteData.offset_x,this.spriteData.offset_y),this.animations[i].push(a)}}},t}(c)).prototype,"image",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=t(D.prototype,"config",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=D))||v));r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});